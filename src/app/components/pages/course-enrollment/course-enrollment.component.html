<mat-card class="course-details" *ngIf="course">
  <mat-card-header>
    <mat-card-title>{{ course.name }}</mat-card-title>
  </mat-card-header>

  <img
    [src]="course.image"
    [alt]="course.name + ' cover image'"
    [srcset]="course.image"
  />

  <mat-card-content>
    <p class="course-description">{{ course.description }}</p>
  </mat-card-content>
</mat-card>

<aside class="course-enrollment">
  <mat-stepper orientation="vertical" [linear]="true" #stepper>
    <mat-step [stepControl]="firstFormGroup">
      <form [formGroup]="firstFormGroup" class="form-container">
        <ng-template matStepLabel>Choose subscription</ng-template>
        <mat-form-field class="form-field" formControlName="subscription">
          <mat-select
            formControlName="subscription"
            [(ngModel)]="defaultSubscription"
            (selectionChange)="getSubscriptionPrices()"
          >
            <mat-option
              *ngFor="let purchase of course?.purchaseOptions"
              [value]="purchase.id"
              >{{ purchase.name }} ({{ purchase.description }})</mat-option
            >
          </mat-select>
        </mat-form-field>

        <mat-form-field class="form-field">
          <mat-select formControlName="currency" [(ngModel)]="defaultPrice">
            <mat-option
              *ngFor="let subscription of subscriptionPrices"
              [value]="subscription.value"
              >{{
                subscription.value | currency : subscription.currency
              }}</mat-option
            >
          </mat-select>
        </mat-form-field>

        <div class="form-footer">
          <button mat-flat-button color="primary" matStepperNext>Next</button>
        </div>
      </form>
    </mat-step>

    <mat-step [stepControl]="secondFormGroup">
      <form [formGroup]="secondFormGroup" class="form-container">
        <ng-template matStepLabel>Starting date</ng-template>

        <mat-form-field class="form-field">
          <mat-label>Choose a date</mat-label>
          <input
            matInput
            formControlName="startingDate"
            [matDatepickerFilter]="myFilter"
            [matDatepicker]="picker"
          />
          <mat-hint>MM/DD/YYYY</mat-hint>
          <mat-datepicker-toggle
            matIconSuffix
            [for]="picker"
          ></mat-datepicker-toggle>
          <mat-datepicker #picker></mat-datepicker>
        </mat-form-field>

        <div class="form-footer">
          <button mat-flat-button color="accent" matStepperPrevious>
            Back
          </button>
          <button mat-flat-button color="primary" matStepperNext>
            Confirmar
          </button>
        </div>
      </form>
    </mat-step>

    <mat-step>
      <ng-template matStepLabel>Done</ng-template>
      <p>You are now done.</p>
      <div>
        <button mat-button matStepperPrevious>Back</button>
        <button mat-button (click)="stepper.reset()">Reset</button>
      </div>
    </mat-step>
  </mat-stepper>
</aside>
